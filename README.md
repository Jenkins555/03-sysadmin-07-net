# Домашнее задание к занятию «Компьютерные сети. Лекция 2»

### Цель задания

В результате выполнения задания вы:

* познакомитесь с инструментами настройки сети в Linux, агрегации нескольких сетевых интерфейсов, отладки их работы;
* примените знания о сетевых адресах на практике для проектирования сети.


### Инструкция к заданию

1. Создайте .md-файл для ответов на вопросы задания в своём репозитории, после выполнения прикрепите ссылку на него в личном кабинете.
2. Любые вопросы по выполнению заданий задавайте в чате учебной группы или в разделе «Вопросы по заданию» в личном кабинете.


### Дополнительные материалы для выполнения задания

1. [Онлайн-калькулятор сетей](https://calculator.net/ip-subnet-calculator.html).
2. Калькулятор сетей — программа ipcalc (`apt install ipcalc`). Если есть графический интерфейс, то у программы-калькулятора есть инженерный режим, там можно считать и сети.

------

## Задание

1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?  
     ```
       Для Linux - ifconfig , ip addr 
       Для Windows - ifconfig 


       vagrant@vagrant:~$ ip addr
    1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
        link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
        inet 127.0.0.1/8 scope host lo
           valid_lft forever preferred_lft forever
        inet6 ::1/128 scope host
           valid_lft forever preferred_lft forever
    2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
        link/ether 08:00:27:b1:28:5d brd ff:ff:ff:ff:ff:ff
        inet 10.0.2.15/24 brd 10.0.2.255 scope global dynamic eth0
           valid_lft 60054sec preferred_lft 60054sec
        inet6 fe80::a00:27ff:feb1:285d/64 scope link
           valid_lft forever preferred_lft forever

     ```

2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?   
             ```
                  ARP (Address Resolution Protocol) - это протокол сетевого уровня, который используется для преобразования сетевых адресов (IP-адресов) в физические адреса (MAC-адреса) для передачи данных в локальной сети.
                  ARP работает только для устройств в пределах одной сети. 

                 В Linux для работы с протоколом ARP можно использовать следующие команды:

                   arp - команда для просмотра и изменения таблицы ARP.
                   arping - команда для отправки ARP-запроса на указанный IP-адрес и получения ответа от соответствующего устройства.   

                   Кроме того, в Linux существует пакет tcpdump, который позволяет анализировать сетевой трафик, включая ARP-запросы и ответы.
             ```

3. Какая технология используется для разделения L2-коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.      

            ```
                   Технология, используемая для разделения L2-коммутатора на несколько виртуальных сетей, называется VLAN (Virtual Local Area Network)     
                   VLAN позволяет разбить одну физическую сеть на несколько логических, каждая из которых может быть настроена как отдельная сеть с собственными параметрами, правами доступа и политиками безопасности.

                   В Linux для настройки VLAN можно использовать утилиту `ip`, а так же пакет `vlan`.   

                   Для настройки IP-адреса и других параметров сетевого интерфейса, включая VLAN-интерфейсы, можно использовать команду ifconfig или более новую команду ip addr.

                   Конфигурация VLAN в Linux выполняется с помощью утилиты ip и файла конфигурации интерфейсов /etc/network/interfaces.

                    Содержание файла конфига eth0.cfg   

                       auto eth0.10
                       iface eth0.10 inet static
                       address 192.168.10.1
                       netmask 255.255.255.0
                       vlan-raw-device eth0   


                  Далее:

                  sudo ip link add link eth0 name eth0.10 type vlan id 10  -  команда создаст виртуальный интерфейс eth0.10 с ID VLAN 10 на основном интерфейсе eth0.  

                  sudo ifup eth0.10 - запуск виртуального интерфейса.

            ```

4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.   

       ```
         В Linux существует несколько типов агрегации интерфейсов (также известных как bonding):

               Round-robin (mode=0) - пакеты последовательно отправляются по всем интерфейсам в агрегации.  
               
               Active-backup (mode=1) - один интерфейс является активным, а другой резервным. В случае отказа активного интерфейса, трафик автоматически переключается на резервный интерфейс.  
               
               XOR (mode=2) - исходящие пакеты отправляются по одному интерфейсу, в зависимости от значения хэша MAC-адреса отправителя и приемника.  
               
               Broadcast (mode=3) - все пакеты отправляются через все интерфейсы в агрегации.  
               
               IEEE 802.3ad Dynamic link aggregation (mode=4) - интерфейсы в агрегации используют протокол LACP (Link Aggregation Control Protocol), который позволяет динамически добавлять и удалять интерфейсы в агрегации в зависимости от состояния сети.  
               
               Adaptive transmit load balancing (mode=5) - исходящие пакеты отправляются по наименее загруженному интерфейсу в агрегации. Это осуществляется на основе статистики передачи исходящих пакетов на каждом интерфейсе в агрегации.  
               
               Adaptive load balancing (mode=6) - пакеты разбиваются на фрагменты и отправляются по наименее загруженным интерфейсам в агрегации. Это позволяет более равномерно распределить нагрузку между всеми интерфейсами.  
                             
           Для каждого типа агрегации интерфейсов доступны различные опции для балансировки нагрузки, такие как:

               miimon - интервал мониторинга состояния интерфейсов.
               mode - тип агрегации интерфейсов.
               xmit_hash_policy - алгоритм хэширования для балансировки нагрузки.
               lacp_rate - скорость отправки кадров протокола LACP.
               arp_interval - интервал отправки ARP-запросов для динамической агрегации интерфейсов.
               arp_ip_target - адрес для отправки ARP-запросов в динамической агрегации интерфейсов.    
               
               Конфиг файл:

                  auto bond0
                    iface bond0 inet static
                      address 192.168.0.10
                      netmask 255.255.255.0
                      gateway 192.168.0.1
                      bond-mode balance-rr    ----- использование режима балансировки нагрузки с обеспечением отказоустойчивости.
                      bond-miimon 100         ----- мониторинг интерфейсов должен производиться каждые 100 миллисекунд.
                      bond-slaves eth0 eth1   ----- для агрегирования должны использоваться интерфейсы eth0 и eth1.
                                
       ```

5. Сколько IP-адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.   

  ```
  Сеть с маской /29 имеет 2^3 = 8 адресов, включая адрес сети и широковещательный адрес. Таким образом, из сети с маской /29 можно использовать 6 адресов для устройств.
  
  Сеть с маской /24 имеет 2^8 = 256 адресов, включая адрес сети и широковещательный адрес. Каждая подсеть с маской /29 включает в себя 8 адресов, включая адрес сети и широковещательный адрес. Следовательно, из сети   с маской /24 можно получить (2^5=32) подсети с маской /29.   
  
  Примеры подсетей:   

         Мы должны разбить сеть 10.10.10.0/24 на подсети, используя маску /29. Каждая подсеть будет иметь 8 IP-адресов (6 из которых доступны для использования), поэтому мы будем использовать адреса, кратные 8 (так как каждый октет может содержать 256 адресов, а /29 использует 8 адресов).

     Мы можем получить следующие подсети с маской /29 внутри сети 10.10.10.0/24:

     10.10.10.0/29
     10.10.10.8/29
     10.10.10.16/29
     10.10.10.24/29
     10.10.10.32/29
     и т.д. до 10.10.10.224/29   
     
  ```

6. Задача: вас попросили организовать стык между двумя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP-адреса? Маску выберите из расчёта — максимум 40–50 хостов внутри подсети.   
      ```
                Будем использовать диапазон 100.64.0.0/10 с маской  /26 . Эта маска позволяет иметь 64 адреса, 62 из которых можно использовать для хостов, а два адреса зарезервированы для адреса сети и широковещательного адреса.    
               100.64.0.0/26
               100.64.64.0/26
               100.64.128.0/26
               100.64.192.0/26
               100.65.0.0/26

      ```
8. Как проверить ARP-таблицу в Linux, Windows? Как очистить ARP-кеш полностью? Как из ARP-таблицы удалить только один нужный IP?    

  ```
    ARP-таблица - это таблица соответствия между MAC-адресами и IP-адресами, которая используется для быстрого определения MAC-адреса устройства, к которому нужно отправить пакет данных.   
    
    Команда arp -a для просмотра ARP-таблицы.   
    
    vagrant@vagrant:~$ arp -an
     ? (10.0.2.3) at 52:54:00:12:35:03 [ether] on eth0
     ? (10.0.2.2) at 52:54:00:12:35:02 [ether] on eth0    
     
     Очистить ARP-кеш полностью в Linux:
      sudo ip -s -s neigh flush all  ИЛИ  sudo arp -d -a

     очистить ARP-кеш полностью в Windows:   
      netsh interface ip delete arpcache   
      
     Удалить только один нужный IP в Linux:   
      sudo arp -d <ip_address>   
     Удалить только один нужный IP в Windows:   
      arp -d <ip_address>
      
  ```

*В качестве решения отправьте ответы на вопросы и опишите, как они были получены.*

---

## Задание со звёздочкой* 

Это самостоятельное задание, его выполнение необязательно.

 8. Установите эмулятор EVE-ng.
 
[Инструкция по установке](https://github.com/svmyasnikov/eve-ng).

Выполните задания на lldp, vlan, bonding в эмуляторе EVE-ng. 
 
----

### Правила приёма домашнего задания

В личном кабинете отправлена ссылка на .md-файл в вашем репозитории.


### Критерии оценки

Зачёт:

* выполнены все задания;
* ответы даны в развёрнутой форме;
* приложены соответствующие скриншоты и файлы проекта;
* в выполненных заданиях нет противоречий и нарушения логики.

На доработку:

* задание выполнено частично или не выполнено вообще;
* в логике выполнения заданий есть противоречия и существенные недостатки.  
 
Обязательными являются задачи без звёздочки. Их выполнение необходимо для получения зачёта и диплома о профессиональной переподготовке.

Задачи со звёздочкой (*) являются дополнительными или задачами повышенной сложности. Они необязательные, но их выполнение поможет лучше разобраться в теме.
